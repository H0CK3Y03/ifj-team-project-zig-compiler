.IFJcode24
CREATEFRAME
CALL main
EXIT int@0
LABEL &strcmp
PUSHFRAME
CREATEFRAME
DEFVAR TF@s1
DEFVAR TF@s2
POPS TF@s2
POPS TF@s1
DEFVAR TF@cnt
LT TF@cnt TF@s1 TF@s2
JUMPIFEQ &strcmp_smaller TF@cnt bool@true
GT TF@cnt TF@s1 TF@s
JUMPIFEQ &strcmp_bigger TF@cnt bool@true
MOVE TF@res int@0
RETURN
LABEL &strcmp_smaller
MOVE TF@res int@-1
RETURN
LABEL &strcmp_bigger
MOVE TF@res int@1
PUSHS TF@res
POPFRAME
RETURN
LABEL &substring
PUSHFRAME
CREATEFRAME
DEFVAR TF@s
DEFVAR TF@i
DEFVAR TF@j
POPS TF@j
POPS TF@i
POPS TF@s
DEFVAR TF@res
MOVE TF@res string@
DEFVAR TF@cnt_err
LT TF@cnt_err TF@i int@0
JUMPIFEQ &substring_err TF@cnt_err bool@true
LT TF@cnt_err TF@j int@0
JUMPIFEQ &substring_err TF@cnt_err bool@true
LT TF@cnt_err TF@j TF@i
JUMPIFEQ &substring_err TF@cnt_err bool@true
DEFVAR TF@len
STRLEN TF@len TF@s
GT TF@cnt_err TF@j TF@len
JUMPIFEQ &substring_err TF@cnt_err bool@true
LT TF@cnt_err TF@i TF@len
NOT TF@cnt_err TF@cnt_err
JUMPIFEQ &substring_err TF@cnt_err bool@true
DEFVAR TF@char
LABEL &substring_loop
JUMPIFEQ &substring_loop_end TF@i TF@j
GETCHAR TF@char TF@s TF@i
CONCAT TF@res TF@res TF@char
ADD TF@i TF@i int@1
JUMP &substring_loop
LABEL &substring_loop_end
PUSHS TF@res
POPFRAME
RETURN
LABEL &substring_err
PUSHS nil@nil
POPFRAME
RETURN

LABEL main
PUSHFRAME
CREATEFRAME
DEFVAR TF@str1
PUSHS string@Hello
POPS TF@str1
DEFVAR TF@str2
PUSHS string@(null)
POPS TF@str2
DEFVAR TF@result
# substring
PUSHS TF@str1
PUSHS int@4
PUSHS int@2
CALL &substring
POPS TF@result
DEFVAR TF@result2
# substring
PUSHS TF@str2
PUSHS int@0
PUSHS int@1
CALL &substring
POPS TF@result2
POPFRAME
RETURN
